
&НаСервере
Функция Команда1НаСервере()
	ТабДок = Новый ТабличныйДокумент;
	Макет = Отчеты.ОтчетШтрихкод.ПолучитьМакет("МакетШтрихкод");
	Область = Макет.ПолучитьОбласть("ОбластьШтрихкод");
	Наименование = Отчет.Наименование.Код;
	МестоУстановки = Отчет.МестоУстановки.Код;
	//Обратите внимание на совпадение имен отчета, макета и области в модуле и в дизайне
	
	barcode = ПолучитьCOMОбъект("","STROKESCRIBE.StrokeScribeClass.1");
	//Вы не забыли установить StrokeScribe?
	
	ИмяФайла=ПолучитьИмяВременногоФайла("wmf");
	//Временный файл во временном каталоге с расширением .wmf
	
	barcode.Alphabet=25;//QR CODE
	barcode.Text=Строка(Наименование)+";"+Строка(МестоУстановки);//Данные для штрихкода

	
	код=barcode.SavePicture(ИмяФайла, 7, //7=WMF
	100, //Ширина картинки штрихкода
	100); //Высота штрихкода
	
	Если код<>0 Тогда //Проверка результата генерации штрихкода
		Сообщить(строка(код) + " - " + barcode.ErrorDescription);
		Возврат Ложь;
	КонецЕсли;
	
	//Убедитесь в совпадении имени объекта рисунка здесь и в дизайне
	рис=Область.Рисунки.РисунокШтрихкод;
	
	рис.РазмерКартинки=РазмерКартинки.Пропорционально;
	рис.Линия = Новый Линия(ТипЛинииРисункаТабличногоДокумента.НетЛинии);
	//Вокруг штрихкода не должно быть рамки
	
	рис.Картинка = Новый Картинка(ИмяФайла);//Загрузка картинки со штрихкодом
	//Указывается то же имя файла, что и в SavePicture
	
	ТабДок.Вывести(Область);
	УдалитьФайлы(ИмяФайла);//Стереть временный файл с картинкой
	
	Возврат ТабДок;
	
КонецФункции

&НаКлиенте
Процедура Команда1(ПараметрКоманды, ПараметрыВыполненияКоманды)
	
	ТабДок1=Команда1НаСервере();
	Если ТабДок1<>Ложь Тогда
		ТабДок1.Показать();
	КонецЕсли;
	
КонецПроцедуры
